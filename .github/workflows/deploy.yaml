name: ðŸš€ Deploy Laravel App

on:
  push:
    branches:
      - master

jobs:
  deploy:
    runs-on: ubuntu-latest

    env:
      repo_path: "/var/www/kratombot"
      repo_url: "git@github.com:foxcreator/KratomBot.git"

    steps:
      - name: Ensure repo exists
        run: |
          if [ ! -d "$repo_path/.git" ]; then
          echo "ðŸ“¦ Cloning repository..."
          git clone $repo_url $repo_path
          else
          echo "âœ… Repository already exists"
          fi

      - name: Pull latest code
        run: |
          cd $repo_path
          git reset --hard
          git pull origin master

      - name: Run Laravel commands
        run: |
          cd $repo_path
          php artisan migrate --force
          php artisan config:cache
          php artisan route:cache
          php artisan view:cache
